# Copyright (c) 2014 The Chromium OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

description   "Configure static IP to eth1 and disable wlan0 for moblab"
author        "chromium-os-dev@chromium.org"

start on started shill

script
  SERVER_ADDRESS=192.168.231.1
  SERVER_NETMASK=255.255.255.0

  # Disable shill against eth1 and wlan0
  logger -t "${UPSTART_JOB}" "restarting shill with eth1 and wlan0 blacklisted"
  restart shill BLACKLISTED_DEVICES=eth1,wlan0

  # Add delay to initiate USB-Ethernet dongle on eth1
  sleep 5

  # Configure server IP address with ${SERVER_ADDRESS}
  logger -t "${UPSTART_JOB}" "setting server IP address to ${SERVER_ADDRESS}"
  ifconfig eth1 ${SERVER_ADDRESS} netmask ${SERVER_NETMASK}
end script
